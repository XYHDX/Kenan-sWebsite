(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8808],{3512:(e,a,l)=>{Promise.resolve().then(l.bind(l,8883))},4981:(e,a,l)=>{"use strict";l.d(a,{A:()=>s});let s=(0,l(4091).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8883:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>p});var s=l(2860),r=l(3200),t=l(3963),o=l(4768),i=l(6372),n=l(3625),d=l(2453),c=l(8727),m=l(4981),u=l(1084),g=l(8886);let p=()=>{let e=(0,r.useRef)(null),[a,l]=(0,r.useState)(null),[p,f]=(0,r.useState)(!1),[b,h]=(0,r.useState)(!0),[x,y]=(0,r.useState)({name:"Yahya Demeriah",title:"IT Engineer & Robotics Specialist",email:"yahyademeriah@gmail.com",phone:"+963 956 633 888",location:"Masaken Barzeh, Damascus, Syria",summary:"Results-driven IT Engineer and Robotics Specialist with over 3 years of experience leading teams, designing robotic systems, and optimizing IT infrastructures. Demonstrated success in mentoring junior engineers and students, and recognized for implementing robust IT solutions. Skilled in emerging technologies and cross-functional collaboration to drive innovation.",profileImage:"/images/profile-pic.png"}),[v,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{h(!0);try{let e=await fetch("/api/admin/profile");if(console.log("Profile API response status:",e.status),e.ok){let a=await e.json();if(console.log("Profile data from API:",a),a&&"name"in a&&a.name)y(a),console.log("Updated form data from API");else{console.log("API returned empty or invalid data, using localStorage fallback");let e=(0,g.zM)(g.d5.PROFILE,x);e&&e.name&&(y(e),console.log("Updated form data from localStorage"))}}else{console.log("API request failed, using localStorage fallback");let e=(0,g.zM)(g.d5.PROFILE,x);e&&e.name&&(y(e),console.log("Updated form data from localStorage"))}}catch(e){console.error("Error fetching profile data:",e)}finally{h(!1)}})()},[]);let k=e=>{let{name:a,value:l}=e.target;y(e=>({...e,[a]:l}))},S=()=>{e.current&&e.current.click()},P=async e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!s)return;let r=new FileReader;r.onloadend=()=>{l(r.result)},r.readAsDataURL(s),f(!0),w("");try{console.log("Starting image upload for file:",s.name);let e=new FormData;e.append("file",s);let a="",l=!1;try{console.log("Sending request to /api/admin/upload");let l=await fetch("/api/admin/upload",{method:"POST",body:e});console.log("Upload response status:",l.status);let s=await l.json();if(console.log("Upload response data:",s),!l.ok)throw Error(s.error||"Failed to upload image");if(!s.imageUrl)throw Error("No image URL returned from server");a=s.imageUrl}catch(e){return console.warn("Server file upload failed, falling back to data URL:",e),new Promise(e=>{let r=new FileReader;r.onloadend=async()=>{a=r.result,l=!0;let s={...x,profileImage:a};y(s);try{await I(s),w("Image stored as data URL and saved to profile.")}catch(e){console.error("Error saving profile with data URL:",e),w("Image stored as data URL (client-side only). Click Save Changes to persist.")}f(!1),e()},r.readAsDataURL(s)})}if(!l){let e={...x,profileImage:a};y(e);try{await I(e),w("Image uploaded and saved successfully!")}catch(e){console.error("Error saving profile after upload:",e),w("Image uploaded but not saved. Click Save Changes to persist.")}}}catch(e){console.error("Error handling image:",e),w("Failed to upload image. Please try again. "+(e instanceof Error?e.message:"")),l(null)}finally{f(!1)}},I=async e=>{if((0,g.lk)(g.d5.PROFILE,e),!(await fetch("/api/admin/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Failed to save profile")},E=async e=>{e.preventDefault(),j(!0),w("");try{await I(x),w("Profile updated successfully!")}catch(e){console.error("Error saving profile:",e),w("An error occurred while saving. Please try again.")}finally{j(!1)}};return(0,s.jsxs)(t.A,{activePage:"profile",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Profile"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Update your personal information and professional summary"})]}),N&&(0,s.jsx)("div",{className:"p-4 mb-6 rounded-md ".concat(N.includes("error")||N.includes("Failed")?"bg-red-50 text-red-700":"bg-green-50 text-green-700"),children:N}),b?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,s.jsxs)("form",{onSubmit:E,children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(o.A,{size:18,className:"text-gray-400"})}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:x.name,onChange:k,className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Your full name"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Professional Title"}),(0,s.jsx)("input",{type:"text",id:"title",name:"title",value:x.title,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Your professional title"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(i.A,{size:18,className:"text-gray-400"})}),(0,s.jsx)("input",{type:"email",id:"email",name:"email",value:x.email,onChange:k,className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Your email address"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(n.A,{size:18,className:"text-gray-400"})}),(0,s.jsx)("input",{type:"text",id:"phone",name:"phone",value:x.phone,onChange:k,className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Your phone number"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(d.A,{size:18,className:"text-gray-400"})}),(0,s.jsx)("input",{type:"text",id:"location",name:"location",value:x.location,onChange:k,className:"pl-10 w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Your location"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"profile-image",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profile Image"}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"relative w-40 h-40 rounded-full overflow-hidden border-4 border-white shadow-md mb-4 cursor-pointer",onClick:S,children:p?(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 bg-opacity-50",children:(0,s.jsx)(c.A,{size:40,className:"animate-spin text-blue-600"})}):(0,s.jsx)(u.default,{src:a||x.profileImage||"/images/profile-pic.png",alt:"Profile",fill:!0,className:"object-cover"})}),(0,s.jsx)("input",{ref:e,id:"profile-image",type:"file",accept:"image/*",className:"hidden",onChange:P}),(0,s.jsx)("button",{type:"button",onClick:S,className:"bg-blue-50 text-blue-700 px-4 py-2 rounded-md hover:bg-blue-100 transition-colors",disabled:p,children:p?"Uploading...":"Change Image"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-700 mb-1",children:"Professional Summary"}),(0,s.jsx)("textarea",{id:"summary",name:"summary",rows:8,value:x.summary,onChange:k,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800",placeholder:"Write a brief professional summary"})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)("button",{type:"submit",disabled:v||p,className:"flex items-center px-6 py-2 rounded-md text-white ".concat(v||p?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"," transition-colors"),children:[v?"Saving...":"Save Changes",!v&&(0,s.jsx)(m.A,{size:18,className:"ml-2"})]})})]},x.profileImage)})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[4612,5284,3963,9685,9411,7358],()=>a(3512)),_N_E=e.O()}]);